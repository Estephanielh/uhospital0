<!DOCTYPE html>
<html>

<body>

    <head>
        <link rel="stylesheet" href="styles.css">
        <title>Solicitar Cita | UHospital</title>
    </head>
    <form class="black form" id="form">
        <h1>Solicitar una Cita</h1>
        <br>
        <label for="fecha">Fecha</label><br>
        <input id="fecha" type="date">
        <br><br>
        <label for="hora">Hora</label><br>
        <input id="hora" type="time">
        <br><br>
        <label for="motivo">Motivo de la cita</label><br>
        <textarea id="motivo" style="width: 100%; height: 50px;" placeholder="Motivo de la cita"></textarea>
        <br><br><br>
        <button class="largebutton" id="submit">Solicitar Cita</button>
    </form>
    <script>
        let form = document.getElementById("form");
        let fecha = document.getElementById("fecha");
        let hora = document.getElementById("hora");
        let motivo = document.getElementById("motivo");
        //URL parameters
        const queryStrings = window.location.search;
        const urlParams = new URLSearchParams(queryStrings);
        const paciente = urlParams.get("patient");
        form.addEventListener("submit", (e) => {
            e.preventDefault();
        });
        submit.addEventListener("click", (e) => {
            const newAppointment = {
                patient: paciente,
                date: fecha.value,
                time: hora.value,
                description: motivo.value
            };
            console.log(newAppointment);
            fetch("https://uhospital0.herokuapp.com/appointment", {
                    method: "POST",
                    headers: {
                        "content-type": "application/json",
                    },
                    body: JSON.stringify(newAppointment),
                })
                .then((response) => response.json())
                .then((data) => {
                    if (data.message) {
                        console.error(data);
                    } else {
                        alert("Cita Solicitadada")
                        location.href = document.referrer;
                    }
                })
                .catch((error) => console.error(error));
        });
    </script>
</body>

</html>